@{
    Layout = null;
    ViewData["Title"] = "Sign Up - QuickCab";
    var signUpSuccess = TempData["SignUpSuccess"] as string;
}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
    <title>@ViewData["Title"]</title>
    <link rel="stylesheet" type="text/css" href="/css/SignUp.css" />
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;800&display=swap" rel="stylesheet" />
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<body>
    <div class="main">
        <!-- Sign Up Container -->
        <div class="container a-container" id="a-container">
            <form id="a-form" class="form" method="post" action="/Account/SignUp">
                <h2 class="form_title title">Create Account</h2>

                <select class="form__input" name="Role" id="roleSelector" required>
                    <option value="">I am a...</option>
                    <option value="passenger">Passenger</option>
                    <option value="driver">Driver</option>
                </select>

                <input class="form__input" type="text" placeholder="Name" name="FullName" required />
                <input class="form__input" type="email" placeholder="Email" name="Email" required />
                <input class="form__input" type="number" placeholder="Phone" name="PhoneNumber" required />
                <input class="form__input" type="password" placeholder="Password" name="Password" required />

                <div id="driverFields" style="display:none;">
                    <input class="form__input" type="text" placeholder="Car Model" name="CarModel" />
                    <input class="form__input" type="text" placeholder="License Plate" name="LicensePlate" />
                </div>

                <button class="form__button button submit" type="submit">SIGN UP</button>
            </form>
        </div>

        <!-- Sign In Container -->
        <div class="container b-container" id="b-container">
            <form id="b-form" class="form" method="post" action="/Account/SignIn">
                <h2 class="form_title title">Sign in to Website</h2>
                <div class="form__icons">
                    <a href="/signin-google">
                        <img class="form__icon" src="/images/icon-google.svg" alt="Google" />
                    </a>
                </div>

                <span class="form__span">or use your email account</span>
                <input class="form__input" type="email" placeholder="Email" name="Email" required autofocus />
                <input class="form__input" type="password" placeholder="Password" name="Password" required />

                <label style="display:flex; align-items:center; margin: 15px 0;">
                    <input type="checkbox" name="RememberMe" style="margin-right: 8px;" />
                    Remember Me
                </label>

                <button class="form__button button submit" type="submit">SIGN IN</button>

                @if (TempData["SignInError"] != null)
                {
                    <div style="color:red; margin-top:10px;">@TempData["SignInError"]</div>
                }
            </form>
        </div>

        <!-- Switch Animation -->
        <div class="switch" id="switch-cnt">
            <div class="switch__circle"></div>
            <div class="switch__circle switch__circle--t"></div>

            <div class="switch__container" id="switch-c1">
                <h2 class="switch__title title">Welcome Back!</h2>
                <p class="switch__description description">To keep connected with us please login with your personal info</p>
                <button class="switch__button button switch-btn" type="button">SIGN IN</button>
            </div>
            <div class="switch__container is-hidden" id="switch-c2">
                <h2 class="switch__title title">Hello Friend!</h2>
                <p class="switch__description description">Enter your personal details and start journey with us</p>
                <button class="switch__button button switch-btn" type="button">SIGN UP</button>
            </div>
        </div>
    </div>

    <script>
        // Switch animation logic
        let switchCtn = document.querySelector("#switch-cnt");
        let switchC1 = document.querySelector("#switch-c1");
        let switchC2 = document.querySelector("#switch-c2");
        let switchCircle = document.querySelectorAll(".switch__circle");
        let switchBtn = document.querySelectorAll(".switch-btn");
        let aContainer = document.querySelector("#a-container");
        let bContainer = document.querySelector("#b-container");

        let changeForm = () => {
            switchCtn.classList.add("is-gx");
            setTimeout(() => {
                switchCtn.classList.remove("is-gx");
            }, 1500);

            switchCtn.classList.toggle("is-txr");
            switchCircle[0].classList.toggle("is-txr");
            switchCircle[1].classList.toggle("is-txr");

            switchC1.classList.toggle("is-hidden");
            switchC2.classList.toggle("is-hidden");
            aContainer.classList.toggle("is-txl");
            bContainer.classList.toggle("is-txl");
            bContainer.classList.toggle("is-z200");
        };

        window.addEventListener("load", () => {
            // Switch form animation
            for (let i = 0; i < switchBtn.length; i++) {
                switchBtn[i].addEventListener("click", function (e) {
                    e.preventDefault();
                    changeForm();
                });
            }

            // Show driver fields if role is "driver"
            const roleSelector = document.getElementById("roleSelector");
            const driverFields = document.getElementById("driverFields");

            if (roleSelector) {
                roleSelector.addEventListener("change", function () {
                    driverFields.style.display = this.value === "driver" ? "block" : "none";
                });

                if (roleSelector.value === "driver") {
                    driverFields.style.display = "block";
                }
            }

            // ✅ Show toast if signup success
            const signUpSuccess = @Html.Raw(Json.Serialize(signUpSuccess));
            if (signUpSuccess) {
                Swal.fire({
                    icon: 'success',
                    title: 'Success!',
                    text: signUpSuccess,
                    toast: true,
                    position: 'top-end',
                    showConfirmButton: false,
                    timer: 3000,
                    timerProgressBar: true
                });

                // Switch to Sign In view
                changeForm();
            }
        });
    </script>
</body>
</html>
